# 2024 제70회 전국과학전람회 출품작 
## 프로젝트 주제: AI모션 인식 기술 이용한 과학 퀴즈 연구

## 전국과학전람회 특상수상

https://www.nocutnews.co.kr/news/6233408

##특상은 교원·일반부에 참가한 고실중학교 정원길·양회관 교사가 출품한 'AI모션 인식 기술 이용한 과학 퀴즈 연구' 작품이 선정됐다.

### 교원,일반부 특상(산업 및 에너지 SW IT 융합 부분 포함)



## Mediapipe Quiz
### AI motion recognition with Google Mediapipe, quiz program using PySide
* 제작기간 : 2022.04. ~ 2024.05.
* 전체코드 라인수
  * 2024.10.05. 현재 : 18,328 라인
* 프로젝트 소개
  * Google MediaPipe, PySide6, OpenCV 등을 이용한 영상 제스처 인식을 이용한 퀴즈 게임( AI 학습)
    * 영상인식을 퀴즈 게임 학습에 이용 (4가지 문제 방식)
      1. 일반퀴즈 - 일반 텍스트 문제
      2. 그림 퀴즈 - 문항에 이미지가 포함 되는 문제
      3. 단어 퀴즈 - 단어, 숙어를 위한 문제, 선택 지문 자동 생성
      4. 수학암산 퀴즈 - 문제 자동 생성, 난이도 문항 수준 설정가능
    * 사용자 경험 개선 : OpenCV, MediaPipe -> PySide Widget 전달받아서 처리
    * 가상 키보드, 손가락 카운트 방법 개선
    * 얼굴 기울림 좌,우 기울림에 추가적으로 앞으로 기울림 방식추가 하여 개선 (초기 보정이 필요함)
  * 퀴즈 문제 타이틀(제목) 로그 이미지 설정 가능(png 파일)
  * 빔프로젝터 제어 및 스케쥴 관리 (시리얼 제어)
  * 뮤직박스 기능 (빔프로젝터 동작 시간에 맞추어 음악 재생)
  * 사용자 입력 및 답안 선택 방법
    * 가상키보드 터치 방식
    * 손가락 숫자 및 손모양 인식(1~5, O/X) 방식
    * 머리 움직임 인식(좌, 앞으로, 우)
  * 과자 자동지급기 : 퀴즈게임 점수 보상으로 자동 지급 - 제작중
  * 엑셀 파일을 이용한 사용자 및 퀴즈 문제 관리
  * QR 코드 리더기로 사용자 등록 및 퀴즈게임 시작 (시리얼 제어)
  * QR 코드 사용자ID 생성기 (시리얼 제어) - 제작중

### 작품설명
#### 1. 손가락 모양 및 숫자 인식
영상처리 오픈소스 라이브러리 OpenCV와 구글에서 제공하는 AI프레임워크인 Mediapipe를 활용하여 구현되었다. 사용자의 손가락 동작을 실시간으로 추적하고 인식하여, 이를 가상 키보드 입력이나 퀴즈 응답으로 처리한다.
#### 2. 가상 키보드
OpenCV를 이용해 화면에 표시되며, 손가락 인식을 통해 사용자 입력을 받는다. 사용자는 손동작을 통해 키보드 상의 키를 선택하고 입력할 수 있다.
#### 3. 얼굴인식기능
Mediapipe Face Mesh를 활용하여 구현되었다. 이 기능은 사용자의 얼굴 각도를 인식하고 분석하여, 얼굴을 좌우로 움직이거나 앞으로 숙이는 동작을 감지한다.
#### 4. 시스템 성능 최적화
저사양 PC에서도 원활하게 실행될 수 있도록 해상도와 프레임 속도를 최적화하였다. 퀴즈와 반응하는 그래픽 환경에서는 충분한 해상도와 화질, 프레임 속도를 제공할 수 있도록 최적화하였다.
#### 5. 빔프로젝터 제어 및 자동화 스케줄 관리
흥미를 높이기 위해서 빔프로젝터의 대형화면을 사용하고, 이 빔프로젝터는 자동화 스케줄 관리 기능을 통해 자동으로 켜지고 꺼진다.
#### 6. 자동 캔디 지급기
일정 점수 이상을 획득한 사용자에게 자동으로 캔디(사탕)를 지급하는 장치와 연동된다. 
#### 7. ID 및 퀴즈 문항 관리
엑셀의 장점을 활용하여 문제 생성과 편집이 용이하며, 관리자에게 친화적인 환경을 제공한다. SQLite 데이터베이스를 통해 통계 분석이 가능하여 학습 성과를 평가하고 개선할 수 있다


### 제작 과정
#### 1. 영상처리 최적화
해상도별 영상처리 속도 테스트 및 평가를 통해 최적의 영상처리 해상도를 선정
![image](https://github.com/user-attachments/assets/bdcb2d42-8a7b-4bac-b0bd-3869f2e09e70)

#### 2. 기초 기술 실험 및 테스트
OpenCV를 사용한 영상 처리 테스트
Mediapipe를 이용한 손가락 인식 테스트
손 랜드마크 추출 및 손가락 인식 및 추적 기능 구현
#### 3. 가상 키보드 구현
OpenCV를 활용한 가상 키보드 제작
손인식을 통해 키보드 터치 영역을 처리하는 기능 구현
![image](https://github.com/user-attachments/assets/c5b184c7-dba8-41ab-b23b-085e56f1cf10)

#### 4. 손모양 숫자 인식
손 랜드마크 추출된 포인트에서 다양한 테스트 및 프로그램 변경을 통해 손 숫자 인식율 개선
손 숫자 인식율을 높이기 위한 오류 개선 작업
![image](https://github.com/user-attachments/assets/df079593-af86-4156-a0e4-b301f9d065fa)

#### 5. 얼굴 각도 인식
Mediapipe Face Mesh 테스트
추출된 Face Mesh에서 얼굴 각도와 깊이 각도 추출 및 각도 계산 및 다양한 로직을 구현하여 인식율을 높이는 작업
![image](https://github.com/user-attachments/assets/f0d68d9c-bf8d-4e23-86df-25bb00930b3d)

#### 6. 퀴즈 영상 처리, 그래픽 화면 처리
* 기본 UI 인터페이스 제작:영상처리 프로세스와 화면 UI가 연계 연동되도록 테스트 및 오류와 문제점 개선
* 연동 테스트, 오류 수정 및 성능 평가
* 손가락 인식 결과를 UI에 전송하고, 그래픽 화면에서 신호가 처리 가능한지 확인
* 신호를 가상 키보드 및 손가락 숫자 인식 신호로 발생시키기
* 얼굴 각도의 결과 값을 그래픽 화면에 전달
* 신호를 그래픽 화면에 표시하고, 거리에 따라 확대 축소 추적
* 동작과 얼굴 인식 위치를 그래픽 화면에서 인식 위치와 연동하여 테스트
* 엑셀 파일에서 사용자 정보와 퀴즈 문항 정보를 처리하고, 데이터베이스와 연동
* 퀴즈 진행 프로세스 설계: 퀴즈 메인 프로세스 및 서브 프로세스 간 연동 및 전환 정보 교환 방법 설계
* 퀴즈 결과 연산: 데이터베이스에 축적된 데이터를 기반으로 순위 계산 및 순위 정보 백업
  ![image](https://github.com/user-attachments/assets/4a823427-0004-4865-8745-5390fff2d400)

#### 7. 스케쥴 관리 및 연동 처리
* 빔프로젝터 시리얼 통신 테스트: 통신 제어 테스트 및 연동 명령어 실험
* 퀴즈 프로그램 내에서 스케줄 프로세스 디자인 및 스케줄에 따라 연동 동작 테스트
* 각 과정에서 오류 검사 및 디버깅 과정 반복
* 전시회 모드 기능 추가: ID 생성 프로그램 제작, 터치 모니터 테스트 및 QR 프린터 제작
* QR 리더기 연동 및 동작 추가
* 캔디 지급기 설계, 제작 및 연동
  ![image](https://github.com/user-attachments/assets/9bc1323f-d54a-41ff-89bc-cabdab9f36f6)

#### 8. 퀴즈 프로그램 운영
* 디버깅 및 개선점 분석을 통해 프로그램을 개선
* 과학 퀴즈 문제 선정 효과 분석.

### 폴더 구조
* config | 환경설정 폴더 (설정)
* db | 데이터 베이스 폴더(sqlite3) - 자동 생성
* effect | 효과음악 폴더
* font_install | 퀴즈에 사용되는 폰트 - window/font 폴더에 복사
* image | 이미지 저장
  * 퀴즈프로그램에 사용되는 이미지
  * 퀴즈 대기화면에 사용되는 퀴즈 제목 이미지
* log | 로그 저장
* music | 퀴즈 대기화면에 사용되는 배경음악
* quiz | 퀴즈 파일 폴더 (퀴즈문제 작성)
  * xlsx 파일로 작성하여 저장
* scheduler | 컴퓨터 스케쥴, 빔프로젝터 제어 스케줄 (동작 스케줄 작성)
  * xlsx 파일로 작성
* temp | 프로그램 임시 파일
* user | 학생, 교사 id 작성 파일 (id설정)


### 추후 계획 (예정)
* 글로벌(영문, 다국어) 버전으로 수정 예정
* 유튜브 소개영상 제작 예정
* 실행파일 형태로 프로그램 배포


### 게임화면
* 초상권 보호를 위해 얼굴을 캐릭터 이미지로 가림
![image](https://github.com/bougs93/mediapipe-quiz/assets/45992773/3f1505c4-63b2-4a53-9233-aa5cd44eb7d6)
![image](https://github.com/bougs93/mediapipe-quiz/assets/45992773/982a8bc1-c50f-4d71-943a-95c527067b85)
![image](https://github.com/bougs93/mediapipe-quiz/assets/45992773/3364e28d-fcd8-4d68-ac50-202d7438996f)

### 화면 전환방법
![image](https://github.com/bougs93/mediapipe-quiz/assets/45992773/3d4a4dad-77d1-41dc-b3cb-4965b25236d3)

### 퀴즈문제 등록 방법
![image](https://github.com/bougs93/mediapipe-quiz/assets/45992773/fafe327a-5083-4f52-a77c-3c65513e5bec)

### 컴퓨터 및 빔프로젝터 제어 스케쥴
![image](https://github.com/bougs93/mediapipe-quiz/assets/45992773/dd7d5d9d-a37f-4d1e-a834-d1c5611d77a6)

### Candy dispenser (사탕 자동지급기) - 제작 완료
![image](https://github.com/bougs93/mediapipe-quiz/assets/45992773/2f6ca2c5-90ba-4208-b072-c46a810391a1)


# 업데이트 현황
* 2024-05-09 일반, 전시관 순위 표시 문제 해결
* 2024-05-25 캔디 지급기 완성 및 동작 연동 완료, 기울여 퀴즈 타이머 오류 수정

